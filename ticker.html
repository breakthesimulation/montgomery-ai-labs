<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Price Ticker | Montgomery AI</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #0a0a0f;
      font-family: 'JetBrains Mono', monospace;
      overflow: hidden;
      padding: 20px;
    }
    .ticker-wrap {
      width: 100%;
      overflow: hidden;
      background: linear-gradient(90deg, #0a0a0f 0%, transparent 10%, transparent 90%, #0a0a0f 100%);
      padding: 16px 0;
    }
    .ticker {
      display: flex;
      gap: 40px;
      animation: scroll 30s linear infinite;
      width: max-content;
    }
    @keyframes scroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
    .ticker-item {
      display: flex;
      align-items: center;
      gap: 12px;
      white-space: nowrap;
    }
    .coin {
      font-weight: 600;
      color: #fff;
      font-size: 1rem;
    }
    .price {
      color: #fff;
      font-size: 1rem;
    }
    .change {
      font-size: 0.85rem;
      padding: 4px 8px;
      border-radius: 4px;
    }
    .positive {
      color: #26a69a;
      background: rgba(38, 166, 154, 0.15);
    }
    .negative {
      color: #ef5350;
      background: rgba(239, 83, 80, 0.15);
    }
    .ticker:hover { animation-play-state: paused; }
    
    /* Embeddable snippet */
    #ticker-embed {
      background: #0a0a0f;
      padding: 12px 0;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="ticker-wrap">
    <div class="ticker" id="ticker"></div>
  </div>
  
  <div style="color:#71717a;margin-top:20px;font-family:'Outfit',sans-serif;">
    <p>Copy this to embed:</p>
    <pre style="background:#1e1e24;padding:16px;border-radius:8px;overflow-x:auto;color:#a1a1aa;font-size:0.85rem;">&lt;iframe src="/ticker.html" width="100%" height="60" frameborder="0">&lt;/iframe></pre>
  </div>
  
  <script>
    const API_KEY = '3d79d057a66e65a870a114ac10cd895c';
    
    async function loadPrices() {
      try {
        const res = await fetch('/api/prices?key=' + API_KEY);
        const data = await res.json();
        const prices = data.prices || [];
        
        // Double for seamless loop
        const items = [...prices, ...prices];
        
        document.getElementById('ticker').innerHTML = items.map(p => `
          <div class="ticker-item">
            <span class="coin">${p.coin}</span>
            <span class="price">$${p.price?.toLocaleString()}</span>
            <span class="change ${p.change_24h_pct >= 0 ? 'positive' : 'negative'}">
              ${p.change_24h_pct >= 0 ? '▲' : '▼'} ${Math.abs(p.change_24h_pct).toFixed(2)}%
            </span>
          </div>
        `).join('');
      } catch(e) { console.log(e); }
    }
    
    loadPrices();
    setInterval(loadPrices, 30000);
  </script>
</body>
</html>
